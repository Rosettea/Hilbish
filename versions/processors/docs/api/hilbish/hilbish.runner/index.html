<!doctype html><html><head><title>Module hilbish.runner — Hilbish</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=theme-color content="#ff89dd"><meta content="/Hilbish/hilbish-flower.png" property="og:image"><meta property="og:site_name" content="Hilbish"><meta content="Module hilbish.runner — Hilbish" property="og:title"><meta content="interactive command runner customization" property="og:description"><meta content="interactive command runner customization" name=description><meta name=revisit-after content="2 days"><meta name=keywords content="Lua,Hilbish,Linux,Shell"><meta property="og:locale" content="en_GB"><link rel=canonical href=https://rosettea.github.io/Hilbish/><meta property="og:url" content="https://rosettea.github.io/Hilbish/"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js integrity=sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2 crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/Hilbish/versions/processors/css/syntax.min.eb77978873f3b324603120b558a36c98ad57d6ee7b77928e3bc131bd76c5935a.css integrity="sha256-63eXiHPzsyRgMSC1WKNsmK1X1u57d5KOO8ExvXbFk1o="></link><style>.heading>.heading-link{opacity:0}.heading:hover>.heading-link{visibility:visible;opacity:1;transition:all .1s ease-in}@keyframes highlight{0%{background:0 0}50%{background:#fff2cf}100%{background:0 0}}div:target{animation:highlight 1.2s;animation-timing-function:cubic-bezier(1,-.02,.45,.89)}table{border-width:1px;border-style:solid;border-color:#565c64;border-collapse:collapse;margin-bottom:12px}table td{padding:5px}table tr{border-width:1px}thead{display:none}</style></head><body class="d-flex flex-column min-vh-100" style=overflow-x:hidden><svg xmlns="http://www.w3.org/2000/svg" style="display:none"><symbol id="check-circle-fill" fill="currentcolor" viewBox="0 0 16 16"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zm-3.97-3.03a.75.75.0 00-1.08.022L7.477 9.417 5.384 7.323a.75.75.0 00-1.06 1.06L6.97 11.03a.75.75.0 001.079-.02l3.992-4.99a.75.75.0 00-.01-1.05z"/></symbol><symbol id="info-fill" fill="currentcolor" viewBox="0 0 16 16"><path d="M8 16A8 8 0 108 0a8 8 0 000 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194.0.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703.0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 110-2 1 1 0 010 2z"/></symbol><symbol id="exclamation-triangle-fill" fill="currentcolor" viewBox="0 0 16 16"><path d="M8.982 1.566a1.13 1.13.0 00-1.96.0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889.0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535.0.954.462.9.995l-.35 3.507a.552.552.0 01-1.1.0L7.1 5.995A.905.905.0 018 5zm.002 6a1 1 0 110 2 1 1 0 010-2z"/></symbol></svg><header><nav class="navbar navbar-expand-md sticky-top bg-light border-bottom"><div class=container-fluid><a class=navbar-brand href=/Hilbish><img src=/Hilbish/hilbish-logo-and-text.png alt height=48></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class=nav-item><a href=/Hilbish/versions/processors/ class=nav-link>Home</a></li><li class=nav-item><a href=/Hilbish/versions/processors/install/ class=nav-link>Install</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/ class=nav-link>Docs</a></li><li class=nav-item><a href=/Hilbish/versions/processors/blog/ class=nav-link>Blog</a></li></ul></div></div></nav></header><style>@media(min-width:768px){.sidenav{width:240px}}</style><div class=row><nav class="navbar-expand-md bg-light sidenav border-end"><div class=container><div class="collapse navbar-collapse" id=navbarSupportedContent><nav class="navbar navbar-expand-md bg-light sidenav col" style=margin-top:-20px><ul class="navbar-nav me-auto mb-2 mb-lg-0 flex-column col mt-4"><li class=nav-item><a href=/Hilbish/versions/processors/docs/ class=nav-link><strong>Introduction</strong></a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/getting-started/ class=nav-link><strong>Getting Started</strong></a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/faq/ class=nav-link><strong>Frequently Asked Questions</strong></a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/features/ class=nav-link><strong>Features</strong></a></li><ul style=list-style:none><li class=nav-item><a href=/Hilbish/versions/processors/docs/completions/ class=nav-link>Completions</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/features/notifications/ class=nav-link>Notification</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/features/opts/ class=nav-link>Options</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/features/runner-mode/ class=nav-link>Runner Mode</a></li></ul><li class=nav-item><a href=/Hilbish/versions/processors/docs/hooks/ class=nav-link><strong>Signals</strong></a></li><ul style=list-style:none><li class=nav-item><a href=/Hilbish/versions/processors/docs/hooks/command/ class=nav-link>Command</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/hooks/hilbish/ class=nav-link>Hilbish</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/hooks/signal/ class=nav-link>Signal</a></li></ul><li class=nav-item><a href=/Hilbish/versions/processors/docs/lunacolors/ class=nav-link><strong>Lunacolors</strong></a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/vim-mode/ class=nav-link><strong>Vim Mode</strong></a></li><ul style=list-style:none><li class=nav-item><a href=/Hilbish/versions/processors/docs/vim-mode/actions/ class=nav-link>Actions</a></li></ul><li class=nav-item><a href=/Hilbish/versions/processors/docs/nature/ class=nav-link><strong>Nature</strong></a></li><ul style=list-style:none><li class=nav-item><a href=/Hilbish/versions/processors/docs/nature/dirs/ class=nav-link>Module dirs</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/nature/doc/ class=nav-link>Module doc</a></li></ul><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/ class=nav-link><strong>API</strong></a></li><ul style=list-style:none><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/bait/ class=nav-link>Module bait</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/commander/ class=nav-link>Module commander</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/fs/ class=nav-link>Module fs</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/ class=nav-link>Module hilbish</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.abbr/ class=nav-link>Module hilbish.abbr</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.aliases/ class=nav-link>Module hilbish.aliases</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.completion/ class=nav-link>Module hilbish.completion</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.editor/ class=nav-link>Module hilbish.editor</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.history/ class=nav-link>Module hilbish.history</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.jobs/ class=nav-link>Module hilbish.jobs</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.messages/ class=nav-link>Module hilbish.messages</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.module/ class=nav-link>Module hilbish.module</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.os/ class=nav-link>Module hilbish.os</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.runner/ class=nav-link>Module hilbish.runner</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.timers/ class=nav-link>Module hilbish.timers</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/hilbish/hilbish.userdir/ class=nav-link>Module hilbish.userDir</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/snail/ class=nav-link>Module snail</a></li><li class=nav-item><a href=/Hilbish/versions/processors/docs/api/terminal/ class=nav-link>Module terminal</a></li></ul></ul></nav></div></div></nav><container class="col mt-2" style="padding-left: 20px; padding-right: 20px;"><div><h1>Module hilbish.runner</h1><p><em>interactive command runner customization<br></em></p><h3 id=introduction class=heading>Introduction
<a href=#introduction class=heading-link><i class="fas fa-paperclip"></i></a></h3><p>The runner interface contains functions that allow the user to change
how Hilbish interprets interactive input.
Users can add and change the default runner for interactive input to any
language or script of their choosing. A good example is using it to
write command in Fennel.</p><p>Runners are functions that evaluate user input. The default runners in
Hilbish can run shell script and Lua code.</p><p>A runner is passed the input and has to return a table with these values.
All are not required, only the useful ones the runner needs to return.
(So if there isn&rsquo;t an error, just omit <code>err</code>.)</p><ul><li><code>exitCode</code> (number): Exit code of the command</li><li><code>input</code> (string): The text input of the user. This is used by Hilbish to append extra input, in case
more is requested.</li><li><code>err</code> (string): A string that represents an error from the runner.
This should only be set when, for example, there is a syntax error.
It can be set to a few special values for Hilbish to throw the right
hooks and have a better looking message.<ul><li><code>\&lt;command>: not-found</code> will throw a <code>command.not-found</code> hook
based on what <code>\&lt;command></code> is.</li><li><code>\&lt;command>: not-executable</code> will throw a <code>command.not-executable</code> hook.</li></ul></li><li><code>continue</code> (boolean): Whether Hilbish should prompt the user for no input</li><li><code>newline</code> (boolean): Whether a newline should be added at the end of <code>input</code>.</li></ul><p>Here is a simple example of a fennel runner. It falls back to
shell script if fennel eval has an error.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=ln> 1</span><span class=cl><span class=kd>local</span> <span class=n>fennel</span> <span class=o>=</span> <span class=n>require</span> <span class=s1>&#39;fennel&#39;</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=n>hilbish.runnerMode</span><span class=p>(</span><span class=kr>function</span><span class=p>(</span><span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>	<span class=kd>local</span> <span class=n>ok</span> <span class=o>=</span> <span class=n>pcall</span><span class=p>(</span><span class=n>fennel.eval</span><span class=p>,</span> <span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>	<span class=kr>if</span> <span class=n>ok</span> <span class=kr>then</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>		<span class=kr>return</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>			<span class=n>input</span> <span class=o>=</span> <span class=n>input</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>	<span class=kr>end</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>
</span></span><span class=line><span class=ln>11</span><span class=cl>	<span class=kr>return</span> <span class=n>hilbish.runner</span><span class=p>.</span><span class=n>sh</span><span class=p>(</span><span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=ln>12</span><span class=cl><span class=kr>end</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=functions class=heading>Functions
<a href=#functions class=heading-link><i class="fas fa-paperclip"></i></a></h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><a href=#runner.lua>lua(cmd)</a></td><td>Evaluates <code>cmd</code> as Lua input. This is the same as using <code>dofile</code></td></tr><tr><td><a href=#sh>sh()</a></td><td>nil</td></tr><tr><td><a href=#setMode>setMode(mode)</a></td><td><strong>NOTE: This function is deprecated and will be removed in 3.0</strong></td></tr><tr><td><a href=#setCurrent>setCurrent(name)</a></td><td>Sets Hilbish&rsquo;s runner mode by name.</td></tr><tr><td><a href=#set>set(name, runner)</a></td><td><em>Sets</em> a runner by name. The difference between this function and</td></tr><tr><td><a href=#run>run(input, priv)</a></td><td>Runs <code>input</code> with the currently set Hilbish runner.</td></tr><tr><td><a href=#getCurrent>getCurrent()</a></td><td>Returns the current runner by name.</td></tr><tr><td><a href=#get>get(name)</a></td><td>Get a runner by name.</td></tr><tr><td><a href=#exec>exec(cmd, runnerName)</a></td><td>Executes <code>cmd</code> with a runner.</td></tr><tr><td><a href=#add>add(name, runner)</a></td><td>Adds a runner to the table of available runners.</td></tr></tbody></table><hr><div id=runner.lua><h4 class=heading>hilbish.runner.lua(cmd)
<a href=#runner.lua class=heading-link><i class="fas fa-paperclip"></i></a></h4><p>Evaluates <code>cmd</code> as Lua input. This is the same as using <code>dofile</code><br>or <code>load</code>, but is appropriated for the runner interface.</p><h5 id=parameters class=heading>Parameters
<a href=#parameters class=heading-link><i class="fas fa-paperclip"></i></a></h5><p><code>string</code> <strong><code>cmd</code></strong></p></div><hr><div id=add><h4 class=heading>hilbish.runner.add(name, runner)
<a href=#add class=heading-link><i class="fas fa-paperclip"></i></a></h4><p>Adds a runner to the table of available runners.
If runner is a table, it must have the run function in it.</p><h5 id=parameters-1 class=heading>Parameters
<a href=#parameters-1 class=heading-link><i class="fas fa-paperclip"></i></a></h5><p><code>name</code> <strong><code>string</code></strong><br>Name of the runner</p><p><code>runner</code> <strong><code>function|table</code></strong></p></div><hr><div id=exec><h4 class=heading>hilbish.runner.exec(cmd, runnerName)
<a href=#exec class=heading-link><i class="fas fa-paperclip"></i></a></h4><p>Executes <code>cmd</code> with a runner.
If <code>runnerName</code> is not specified, it uses the default Hilbish runner.</p><h5 id=parameters-2 class=heading>Parameters
<a href=#parameters-2 class=heading-link><i class="fas fa-paperclip"></i></a></h5><p><code>cmd</code> <strong><code>string</code></strong></p><p><code>runnerName</code> <strong><code>string?</code></strong></p></div><hr><div id=get><h4 class=heading>hilbish.runner.get(name)
<a href=#get class=heading-link><i class="fas fa-paperclip"></i></a></h4><p>Get a runner by name.</p><h5 id=parameters-3 class=heading>Parameters
<a href=#parameters-3 class=heading-link><i class="fas fa-paperclip"></i></a></h5><p><code>name</code> <strong><code>string</code></strong><br>Name of the runner to retrieve.</p></div><hr><div id=getCurrent><h4 class=heading>hilbish.runner.getCurrent()
<a href=#getCurrent class=heading-link><i class="fas fa-paperclip"></i></a></h4><p>Returns the current runner by name.</p><h5 id=parameters-4 class=heading>Parameters
<a href=#parameters-4 class=heading-link><i class="fas fa-paperclip"></i></a></h5><p>This function has no parameters.</p></div><hr><div id=run><h4 class=heading>hilbish.runner.run(input, priv)
<a href=#run class=heading-link><i class="fas fa-paperclip"></i></a></h4><p>Runs <code>input</code> with the currently set Hilbish runner.
This method is how Hilbish executes commands.
<code>priv</code> is an optional boolean used to state if the input should be saved to history.</p><h5 id=parameters-5 class=heading>Parameters
<a href=#parameters-5 class=heading-link><i class="fas fa-paperclip"></i></a></h5><p><code>input</code> <strong><code>string</code></strong></p><p><code>priv</code> <strong><code>bool</code></strong></p></div><hr><div id=set><h4 class=heading>hilbish.runner.set(name, runner)
<a href=#set class=heading-link><i class="fas fa-paperclip"></i></a></h4><p><em>Sets</em> a runner by name. The difference between this function and
add, is set will <em>not</em> check if the named runner exists.
The runner table must have the run function in it.</p><h5 id=parameters-6 class=heading>Parameters
<a href=#parameters-6 class=heading-link><i class="fas fa-paperclip"></i></a></h5><p><code>name</code> <strong><code>string</code></strong></p><p><code>runner</code> <strong><code>table</code></strong></p></div><hr><div id=setCurrent><h4 class=heading>hilbish.runner.setCurrent(name)
<a href=#setCurrent class=heading-link><i class="fas fa-paperclip"></i></a></h4><p>Sets Hilbish&rsquo;s runner mode by name.</p><h5 id=parameters-7 class=heading>Parameters
<a href=#parameters-7 class=heading-link><i class="fas fa-paperclip"></i></a></h5><p><code>name</code> <strong><code>string</code></strong></p></div><hr><div id=setMode><h4 class=heading>hilbish.runner.setMode(mode)
<a href=#setMode class=heading-link><i class="fas fa-paperclip"></i></a></h4><p><strong>NOTE: This function is deprecated and will be removed in 3.0</strong>
Use <code>hilbish.runner.setCurrent</code> instead.
This is the same as the <code>hilbish.runnerMode</code> function.
It takes a callback, which will be used to execute all interactive input.
Or a string which names the runner mode to use.</p><h5 id=parameters-8 class=heading>Parameters
<a href=#parameters-8 class=heading-link><i class="fas fa-paperclip"></i></a></h5><p><code>mode</code> <strong><code>string|function</code></strong></p></div><hr><div id=sh><h4 class=heading>hilbish.runner.sh()
<a href=#sh class=heading-link><i class="fas fa-paperclip"></i></a></h4><h5 id=parameters-9 class=heading>Parameters
<a href=#parameters-9 class=heading-link><i class="fas fa-paperclip"></i></a></h5><p>This function has no parameters.</p></div></div><div class="footer mt-auto"><p class="card-small text-muted">Want to help improve this page? <a href=https://github.com/Rosettea/Hilbish/issues/new/choose>Create an issue.</a></p></div></container></div><footer class="footer mt-auto mt-auto py-3 bg-light row border-top"><div class="col mb-3"></div><div class="col mb-3"><a href=/Hilbish class="d-flex align-items-center mb-3 link-dark text-decoration-none"><img src=/Hilbish/hilbish-logo-and-text.png alt height=48 class="d-inline-block align-text-top" style=margin-left:-20px></a><ul class="nav flex-column"><li class="nav-item mb-2"><a href=/Hilbish class="nav-link p-0 text-muted">Home</a></li><li class="nav-item mb-2"><a href=/Hilbish/docs/faq class="nav-link p-0 text-muted">FAQ</a></li><li class="nav-item mb-2"><a href=https://github.com/Rosettea/Hilbish class="nav-link p-0 text-muted">Source</a></li><li class="nav-item mb-2"><a href=https://github.com/Rosettea/Hilbish/releases class="nav-link p-0 text-muted">Releases</a></li><li class="nav-item mb-2"><a href=/Hilbish/docs class="nav-link p-0 text-muted">Documentation</a></li></ul></div><div class="col mb-3"></div><div class="col mb-3"></div><div class="col mb-3"></div><div class="col mb-3"><p class="text-muted mt-4">Rosettea &copy; 2022-2023<br>Made with <i class="fa-solid fa-heart" style=color:#f6345b></i></p></div><div class="col mb-3"></div></footer></body></html>